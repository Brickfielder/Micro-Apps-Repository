<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Shared frame config -->
  <meta name="app-title" content="Audio Errand ‚Äî Planner">
  <meta name="app-badge" content="Prototype">
  <meta name="app-accent" content="Planner">
  <title>Audio Errand ‚Äî Planner ¬∑ Micro Rehab Apps</title>

  <!-- 1) ADD: shared skin (relative path for docs/Apps) -->
  <link rel="stylesheet" href="../shared/theme.css" />

  <!-- 2) KEEP: tiny local overrides only for app-specific widgets (drag boards, pills, etc.) -->
  <style>
    /* App‚Äëspecific visuals (uses shared CSS variables for consistency) */
    .boards{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:700px){.boards{grid-template-columns:1fr}}
    .board{min-height:120px;padding:12px;border-radius:12px;border:1px dashed var(--line);background:#f0f2f8}
    @media (prefers-color-scheme: dark){.board{background:#0f172a}}
    .board h3{margin:0 0 8px;font-size:14px;color:var(--muted)}
    .board .drop{min-height:52px;display:flex;gap:8px;flex-wrap:wrap}
    .pill{display:inline-flex;gap:8px;align-items:center;user-select:none;background:#ffffff;color:#0f172a;border:1px solid var(--line);border-radius:12px;padding:8px 10px;font-size:14px}
    @media (prefers-color-scheme: dark){.pill{background:#111827;color:#e5e7eb}}
    .pill[data-draggable="true"]{cursor:grab}
    .pill.dragging{opacity:.6}
    .hint{font-size:13px;color:var(--muted)}
    .status{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .status .dot{width:10px;height:10px;border-radius:50%}
    .log{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;font-size:12px;white-space:pre-wrap;background:#fafafa;border:1px solid var(--line);border-radius:12px;padding:10px;max-height:200px;overflow:auto}
    @media (prefers-color-scheme: dark){.log{background:#0b1220}}
    .overlay{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.45);backdrop-filter:blur(2px);z-index:20}
    .overlay.show{display:grid}
    .count{font-size:clamp(48px,8vw,96px);font-weight:700;color:var(--text)}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
    .disabled{opacity:.4;pointer-events:none}
  </style>
</head>
<body>
  <!-- 3) ADD: tell the shared frame which buttons to show -->
  <div data-actions="start,csv,help"></div>

  <!-- 4) CONTENT: use shared container/grid/card/buttons -->
  <div class="container">
    <div class="grid">
      <section class="card">
        <h2>Briefing</h2>
        <p class="hint">Listen carefully. You'll hear a list of errands in order. When playback ends, drag the items into the correct sequence and submit.</p>

        <div class="status" aria-live="polite" style="margin:8px 0 12px">
          <span class="dot" id="audioDot" style="background:var(--danger)"></span>
          <span id="audioStatus">Speech: not ready</span>
        </div>

        <div class="card subtle" style="margin:8px 0 12px">
          <b>Tip.</b> Boards unlock only after the audio finishes.
        </div>

        <div class="grid" style="grid-template-columns:1fr;gap:12px">
          <div class="row" style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
            <label for="difficulty">Difficulty (items):</label>
            <select id="difficulty" aria-label="Difficulty" class="btn">
              <option value="3">3</option>
              <option value="4" selected>4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
            <label for="interrupts">Auditory interruptions:</label>
            <select id="interrupts" aria-label="Interruptions" class="btn">
              <option value="none" selected>None</option>
              <option value="one">One</option>
              <option value="random">Random</option>
            </select>
            <label for="distractors">Distractor items shown:</label>
            <select id="distractors" aria-label="Distractors" class="btn">
              <option value="0" selected>0</option>
              <option value="2">2</option>
              <option value="4">4</option>
            </select>
          </div>
          <div class="row" style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
            <label for="voiceSel">Voice:</label>
            <select id="voiceSel" aria-label="Voice" class="btn"></select>
            <label for="rate">Rate:</label>
            <input id="rate" type="range" min="0.7" max="1.4" step="0.05" value="1" />
            <button id="hearingTest" class="btn" title="Play a short sample">Hearing check üîä</button>
          </div>
          <div class="row" style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
            <button id="start" class="btn primary">Start Trial ‚ñ∂Ô∏è</button>
            <button id="stopSpeak" class="btn">Stop Audio ‚èπÔ∏è</button>
            <button id="reset" class="btn">Reset</button>
          </div>
        </div>

        <div class="boards" style="margin-top:12px">
          <div class="board">
            <h3>Available items</h3>
            <div id="pool" class="drop" aria-label="Item pool"></div>
          </div>
          <div class="board">
            <h3>Your sequence</h3>
            <div id="sequence" class="drop" aria-label="Your sequence"></div>
          </div>
        </div>
        <div class="row" style="margin-top:12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap">
          <button id="submit" class="btn">Submit ‚úÖ</button>
          <button id="clearSeq" class="btn">Clear sequence</button>
          <div id="feedback" class="hint" aria-live="polite"></div>
        </div>
      </section>

      <aside class="card">
        <h2>Session</h2>
        <div class="row" style="display:flex;gap:16px;flex-wrap:wrap">
          <div>Trials: <strong id="trialNum">0</strong></div>
          <div>Score: <strong id="score">0</strong></div>
          <div>Time: <strong id="timer">00:00</strong></div>
        </div>
        <div class="log" id="log" aria-label="Log" style="margin-top:12px"></div>
      </aside>
    </div>
  </div>

  <div class="overlay" id="overlay" aria-hidden="true">
    <div class="count" id="count">3</div>
    <span class="sr-only" id="overlaySr">Trial starts soon</span>
  </div>

  <!-- 5) ADD: shared frame behaviour (relative path) -->
  <script defer src="../shared/frame.js"></script>
  
  <!-- 6) APP LOGIC (unchanged except for toolbar event wiring + .btn classes) -->
  <script>
  // ... JS stays same as before (omitted here for brevity) ...
  </script>
</body>
</html>

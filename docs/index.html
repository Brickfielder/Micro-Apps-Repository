<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Micro Rehab Apps</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* ... same CSS as before ... */
    :root{
      --bg:#f7f7f9; --card:#fff; --text:#222; --muted:#666;
      --brand:#0a66c2; --brand-hover:#084f96;
      --shadow:0 8px 20px rgba(0,0,0,.08); --radius:14px; --divider:#eceff3;
      --chip:#eef4fb; --chip-text:#0a66c2; --chip-border:#d8e6f7;
      --pill-shadow:0 4px 10px rgba(10,102,194,.18);
    }
    /* keep the rest of the CSS unchanged */
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img src="assets/Micro_Apps_Banner.png" alt="Micro Apps Banner"
           onerror="this.style.display='none'">
      <h1>Micro Rehab Apps</h1>
      <p class="disclaimer">
        These are experimental prototypes for research and demonstration only.
        They are <strong>not validated tools</strong> and <strong>not medical devices</strong>.
        Use at your own risk.
      </p>
    </header>

    <p class="lead">Select an exercise below:</p>

    <!-- Filter toolbar -->
    <div class="toolbar" role="group" aria-label="Filter by tag">
      <button class="tag-btn" data-tag="visuospatial">Visuospatial <small></small></button>
      <button class="tag-btn" data-tag="executive">Executive <small></small></button>
      <button class="tag-btn" data-tag="auditory">Auditory <small></small></button>
      <button class="tag-btn" data-tag="desktop">Desktop-only <small></small></button>
      <button class="tag-btn" data-tag="language">Language <small></small></button>
      <button class="tag-btn" data-tag="strategy">Strategy Training <small></small></button>
      <button class="tag-btn" data-tag="all">Clear filters</button>
    </div>
    <div class="hint">Tip: select multiple tags to show apps that match <em>any</em> of them.</div>

    <!-- Visuospatial section ... unchanged ... -->

    <!-- Executive section -->
    <section class="section" aria-labelledby="exec-title" id="sec-executive">
      <h2 id="exec-title">ðŸ§  Executive functioning apps</h2>
      <p class="sub">Planning, sequencing, monitoring, inhibition, and strategy.</p>
      <ul>
        <li data-tags="executive">
          <a class="app-pill" href="Errands-visual-memory/index.html">Errands â€“ Visual Memory</a>
          <div class="chips"><span class="chip">Executive</span></div>
        </li>
        <li data-tags="executive auditory">
          <a class="app-pill" href="Audio_Errands/index.html">Audio Errands</a>
          <div class="chips"><span class="chip">Executive</span><span class="chip">Auditory</span></div>
        </li>
        <li data-tags="executive">
          <a class="app-pill" href="Taskflow/index.html">Taskflow: Plan-Check-Feedback</a>
          <div class="chips"><span class="chip">Executive</span></div>
        </li>
        <li data-tags="executive">
          <a class="app-pill" href="Barista_Chaos/index.html">Barista Chaos!</a>
          <div class="chips"><span class="chip">Executive</span></div>
        </li>
        <li data-tags="executive desktop">
          <a class="app-pill" href="Tower_control/index.html">Tower Control â€“ desktop only</a>
          <div class="chips"><span class="chip">Executive</span><span class="chip">Desktop-only</span></div>
        </li>
        <li data-tags="executive desktop">
          <a class="app-pill" href="Emergency_despatch/index.html">Emergency Despatch â€“ desktop only</a>
          <div class="chips"><span class="chip">Executive</span><span class="chip">Desktop-only</span></div>
        </li>
        <li data-tags="executive">
          <a class="app-pill" href="Office_Day/index.html">Office Day</a>
          <div class="chips"><span class="chip">Executive</span></div>
        </li>
        <!-- New Fluency Coach app -->
        <li data-tags="executive language strategy">
          <a class="app-pill" href="Fluency_Coach/index.html">Fluency Coach</a>
          <div class="chips">
            <span class="chip">Executive</span>
            <span class="chip">Language</span>
            <span class="chip">Strategy Training</span>
          </div>
        </li>
      </ul>
    </section>
  </div>

  <script>
    (function(){
      const buttons = Array.from(document.querySelectorAll('.tag-btn'));
      const appItems = Array.from(document.querySelectorAll('li[data-tags]'));
      const sections = Array.from(document.querySelectorAll('.section'));

      const selected = new Set();

      function updateCounts(){
        const tags = [...new Set(appItems.flatMap(el=>el.dataset.tags.split(' ')))];
        const visible = appItems.filter(el => !el.classList.contains('hidden'));
        const byTag = Object.fromEntries(tags.map(t => [t, 0]));
        visible.forEach(el=>{
          el.dataset.tags.split(' ').forEach(t=>{
            if(byTag[t] !== undefined) byTag[t]++;
          });
        });
        buttons.forEach(btn=>{
          const t = btn.dataset.tag;
          const small = btn.querySelector('small');
          if(!small) return;
          if(t === 'all'){ small.textContent = ''; return; }
          small.textContent = byTag[t] ? `(${byTag[t]})` : '(0)';
        });
      }

      function applyFilter(){
        if(selected.size === 0){
          appItems.forEach(el=>el.classList.remove('hidden'));
        } else {
          appItems.forEach(el=>{
            const tags = el.dataset.tags.split(' ');
            const match = [...selected].some(t => tags.includes(t));
            el.classList.toggle('hidden', !match);
          });
        }
        sections.forEach(sec=>{
          const items = Array.from(sec.querySelectorAll('li[data-tags]'));
          const anyVisible = items.some(i => !i.classList.contains('hidden'));
          sec.dataset.empty = anyVisible ? 'false' : 'true';
        });
        updateCounts();
      }

      function toggleTag(tag){
        if(tag === 'all'){
          selected.clear();
          buttons.forEach(b=>b.classList.remove('active'));
          applyFilter();
          return;
        }
        if(selected.has(tag)){ selected.delete(tag); }
        else { selected.add(tag); }
        const btn = buttons.find(b=>b.dataset.tag === tag);
        if(btn) btn.classList.toggle('active');
        applyFilter();
      }

      buttons.forEach(btn=>{
        btn.addEventListener('click', ()=> toggleTag(btn.dataset.tag));
      });

      applyFilter();
    })();
  </script>
</body>
</html>
